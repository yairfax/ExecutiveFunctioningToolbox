<html>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<head>
	<title>Study Timer</title>

	<style>
		body {
			background-color: black;
		}

		#content {
			position: fixed;
			top: 50%;
			right: 50%;
			transform: translate(50%, -50%);
		}

		#timer {
			position: fixed;
			top: 50%;
			right: 50%;
			transform: translate(50%, -50%);
			text-align: center;
			color: white;
			font-size: 100pt
		}
	</style>
</head>

<body>
	<div class="card" style="width: 30rem;" id="content">
		<form id="time-form">
			<div class="card-header" style="text-align: center">
				<button class="btn btn-success" id="start" >Start Timer</button>
			</div>
			<div class="card-body">

				<label>Task 1</label>
				<div id="task1" class="row">
					<div class="col">
						<div class="form-group">
							<input class="form-control" type="text" required id ="task1-name" placeholder="Task 1 Name">
						</div>
					</div>
					<div class="col">
						<div class="form-group">
							<input class="form-control" type="number" min="0" max="60" required id="task1-time" placeholder="Task 1 Time">
						</div>
					</div>
				</div>

				<div class="form-check">
					<input class="form-check-input" type="checkbox" id="task2-checkbox">
					<label clsas="form-check-label">Do you want a second task?</label>
				</div>
				
				<div id="task2" hidden>
					<label for="task2-name">Task 2</label>
					<div class="row">
						<div class="form-group col">
							<input class="form-control task2" type="text" id ="task2-name" placeholder="Task 2 Name">
						</div>
						<div class="form-group col">
							<input class="form-control task2" type="number" min="0" max="60" id="task2-time" placeholder="Task 2 Time">
						</div>
					</div>
				</div>

				<div class="form-group">
					<div class="form-check">
						<input class="form-check-input" type="checkbox" id="break-checkbox">
						<label class="form-check-label">Do you want a break?</label>
					</div>
				</div>
				<div id="break" hidden>
					<div class="form-group">
						<input class="form-control" type="number" min="0" max="60" id="break-time" placeholder="Time for Break">
					</div>
				</div>

				<div class="form-group">
					<label for="times">How many times do you want to cycle?</label>
					<input class="form-control" id="times" type="number" min=1 max=5 placeholder="1">
				</div>
			</div>
		</form>
	</div>

	<div id="timer" hidden>
		Text!
	</div>
</body>

<script>

	function startTimer(i, end) {
		console.log($("#task1-name").val())
		$("#timer").text($("#task1-name").val())
		setTimeout(function() {
			if (!$("#task2").prop("hidden")) {
				console.log($("#task2-name").val())
				$("#timer").text($("#task2-name").val())
				setTimeout(function() {
					if (!$("#break").prop("hidden")) {
						console.log("Break")
						$("#timer").text("Break Time!")
						setTimeout(function() {
							if (i < end) {
								startTimer(i + 1, end)
							} else {
								$("#content").show()
								$("#timer").prop("hidden", true)
							}
						}, parseInt($("#break-time").val()) * multi)
					} else {
						if (i < end) {
							startTimer(i + 1, end)
						} else {
							$("#content").show()
							$("#timer").prop("hidden", true)
						}
					}
				}, parseInt($("#task2-time").val()) * multi)
			} else {
				if (i < end) {
					startTimer(i + 1, end)
				} else {
					$("#content").show()
					$("#timer").prop("hidden", true)
				}
			}
		}, parseInt($("#task1-time").val()) * multi)
	}

	const multi = 1000; // set to secs now, change to minutes later
	$("#task2-checkbox").change(function(event) {
		$("#task2").prop('hidden', !$("#task2").prop('hidden'))
		$(".task2").prop('required', !$(".task2").prop('required'))
		$(".task2").val('')
	})

	$("#break-checkbox").change(function(event) {
		$("#break").prop('hidden', !$("#break").prop('hidden'))
		$("#break").prop('required', !$("#break").prop('required'))
		$("#break-time").val('')
	})

	$("#time-form").submit(function(event) {
		event.preventDefault();
		$("#content").hide()
		$("#timer").prop("hidden", false)

		startTimer(1, (parseInt($("#times").val()) || 1))
		
	})
</script>

</html>